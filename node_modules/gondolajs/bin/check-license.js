!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(8)),s=o(n(3)),a=o(n(9)),c=r(n(10)),u=n(1);t.requestTimeout=10,t.retriesTime=5,t.DATA_PATH=a.join(s.homedir(),".gondola","login.json");const l=g(t.DATA_PATH).server;let f=l||void 0;async function d(){return f||await(async()=>await c.default.getDefaultServer())()}function g(e){let t="",n="",o="";try{if(i.existsSync(e)){const r=i.readFileSync(e,"utf8"),s=JSON.parse(r);t=s.auth,n=s.server,o=s.tokenType}else u.logger.info(e+" does not exist.")}catch(e){u.logger.error("Cannot get previous login info. Error: "+e)}return{auth:t,server:n,tokenType:o}}t.setServerURL=function(e){f=e||void 0},t.getServer=d,t.handleToken=function(e){let n=e;if(n||(n=g(t.DATA_PATH).auth),!n)throw new Error("Missed require arguments: --licenseToken");return n},t.getAuthInfoFromDevice=g,t.saveAuthInfoToDevice=function(e,t,n,o){try{const r=a.dirname(o);u.logger.info("Save dir: "+r),i.existsSync(r)||i.mkdirSync(r),i.writeFile(o,JSON.stringify({auth:e,server:t,tokenType:n}),()=>{})}catch(e){u.logger.error("Cannot cache login info. Error: "+e)}},t.removeAuthInfoFromDevice=function(e){i.unlink(e,e=>{})},function(e){e.Login=async()=>`https://${await d()}/v1/client/login`,e.LicenseInfo=async()=>`https://${await d()}/v1/licenseInfo`,e.Logout=async()=>`https://${await d()}/v1/client/logout`,e.Token=async()=>`https://${await d()}/v1/token`,e.CheckOut=async()=>`https://${await d()}/v1/activeRunner/checkout`,e.CheckIn=async()=>`https://${await d()}/v1/activeRunner/checkin`,e.HeartBeat=async()=>`https://${await d()}/v1/activeRunner/heartBeat`}(t.RequestPath_v1||(t.RequestPath_v1={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logger=new class{setLogger(e){this.logger=e}info(e){this.logger&&"function"==typeof this.logger.info&&this.logger.info(e)}warn(e){this.logger&&"function"==typeof this.logger.warn&&this.logger.warn(e)}error(e){this.logger&&"function"==typeof this.logger.error&&this.logger.error(e)}},t.setLogger=function(e){t.logger.setLogger(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o="Gondola Telemetry:";t.logger=new class{constructor(){this.isActive=!0}setActive(e){this.isActive=e}info(e){this.isActive&&console.log(`${o} ${e}`)}warn(e,t){this.error(e,t)}error(e,t){this.isActive&&(t?console.error(`${o} ${e}`,t):console.error(`${o} ${e}`))}}},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(13)),i=o(n(14)),s=n(0);function a(){return{headers:{"Content-Type":"application/json",timestamp:Math.floor(Date.now()/1e3),product:"GON"},timeout:1e3*s.requestTimeout,raxConfig:{retry:5,noResponseRetries:5,httpMethodsToRetry:["GET","PUT","HEAD","OPTIONS","DELETE","POST"]}}}t.axiosPost=async function(e,t,n){const o=i.attach(),s=a(),c=await r.default.post(e,t?JSON.stringify(t):void 0,{...s,...n});return i.detach(o),c},t.axiosPostWithToken=async function(e,t,n,o){const s=i.attach(),c=a();c.headers["X-API-KEY"]=t;const u=await r.default.post(e,n?JSON.stringify(n):void 0,{...c,...o});return i.detach(s),u},t.axiosGetWithToken=async function(e,t,n){const o=i.attach(),s=a();s.headers["X-API-KEY"]=t;const c=await r.default.get(e,{...s,...n});return i.detach(o),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Extension=0]="Extension",e[e.SpreadSheetEditor=1]="SpreadSheetEditor",e[e.HeliumFW=2]="HeliumFW",e[e.TestBuilder=3]="TestBuilder",e[e.Environment=4]="Environment"}(t.EventCategory||(t.EventCategory={})),function(e){e[e.StartupExtension=0]="StartupExtension",e[e.StartGSE=1]="StartGSE"}(t.UserTimingVariable||(t.UserTimingVariable={}))},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),i=o(n(17)).default(),s=n(18),a=n(25),c=n(3);let u,l;setInterval(()=>{!function(e){try{process.kill(e,0)}catch(e){return"EPERM"===e.code}return!0}(process.ppid)&&d&&(clearInterval(u),r.checkInLicense(i,process.env.token).then(()=>{process.exit()}).catch(e=>{console.log(e.message),process.exit()}))},1e3),process.on("message",async e=>{var t;if("stop"===e&&d&&(await l,clearInterval(u),r.checkInLicense(i,process.env.token).then(()=>{process.exit()}).catch(e=>{process.exit()})),"telemetry"===(null===(t=e)||void 0===t?void 0:t.name)){const t=JSON.parse(e.env),n={isTestExecuted:t.isTestExecuted,av:t.av,uid:process.env.uid,cid:t.cid};if("StartTest"===e.label){const t=JSON.parse(e.properties);await s.sendTelemetryEvent(!0,s.EventCategory.HeliumFW,e.label,void 0,void 0,void 0,t,void 0,n)}else"EndTest"===e.label&&(l=new Promise(async t=>{try{const t=JSON.parse(e.counter),o=new Map;for(const e in t)o.set(e,t[e]);await s.sendActionsStatistic(!0,o,n),await s.sendTelemetryEvent(!0,s.EventCategory.HeliumFW,e.label,void 0,void 0,void 0,void 0,void 0,n)}catch(e){}t(!0)}))}}),""!==process.env.info&&r.setServerURL(process.env.info?process.env.info:void 0);const f={runnerID:i,machineInfo:`${c.hostname()} - ${a.address()}`,agentType:process.env.agent_type?process.env.agent_type:"unknown"};let d=!1;r.checkOutLicense(f,process.env.token).then(e=>{if(process.send&&process.send({licenseState:e.state}),1===e.state){d=!0;const t=1e3*e.heartBeat;u=setInterval(()=>{r.heartbeat(i,process.env.token)},t)}else d=!1;e.userID&&(process.env.uid=e.userID.toString())})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.setServerURL=o.setServerURL;var r=n(1);t.setLogger=r.setLogger;var i=n(12);t.checkInLicense=i.checkInLicense,t.checkOutLicense=i.checkOutLicense,t.Feature=i.Feature,t.getLicenseState=i.getLicenseState,t.heartbeat=i.heartbeat;var s=n(16);t.authLogin=s.authLogin,t.AuthStatus=s.AuthStatus,t.autoLogin=s.autoLogin,t.basicLogin=s.basicLogin,t.genExecutionToken=s.genExecutionToken,t.getLoginState=s.getLoginState,t.getPackagesLicense=s.getPackagesLicense,t.LoginType=s.LoginType,t.logout=s.logout},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(11)),i=n(1),s={timeout:1e4},a=async e=>new Promise(t=>setTimeout(t,e));const c={ping:async function(e,t,n){let o=!1;const c=n&&void 0!==n.timeout&&n.timeout>0?n.timeout:s.timeout,u=Date.now(),l=new r.Socket;return l.on("connect",()=>{i.logger.info("connected to "+t+":"+e+" in "+(Date.now()-u)+"ms"),o=!0,l.end(),l.destroy()}),l.on("timeout",()=>{i.logger.error(t+":"+e+" connection timeout"),l.end(),l.destroy()}),l.on("error",e=>{i.logger.error(e.message)}),l.setTimeout(c),l.connect(e,t),await(async()=>{let e=0;for(;!l.destroyed&&l.connecting&&(await a(50),e++,!(e>=c/50)););return{alive:o}})()},getDefaultServer:async function(){let e="license.gondolatest.com";return(await c.ping(443,"license.logigear.com",s)).alive&&(e="license.logigear.com"),e}};t.default=c},function(e,t){e.exports=require("net")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),r=n(15),i=n(0);!function(e){e[e.aa=0]="aa",e[e.bb=1]="bb"}(t.Feature||(t.Feature={}));const s={heartBeat:0,state:r.LicenseStatus.unknown,features:[],error:"",userID:0};t.checkOutLicense=async function(e,t){let n;s.heartBeat=0,s.state=r.LicenseStatus.unknown,s.features=[],s.error="",s.userID=0;try{n=i.handleToken(t);const r=await o.axiosPostWithToken(await i.RequestPath_v1.CheckOut(),n,e);if(200===r.status){const e=r.data;s.state=e.state,s.heartBeat=e.heartBeat,s.userID=e.userID}}catch(e){s.error=e.message,n?e.response&&400===e.response.status?s.state=r.LicenseStatus.invalidToken:s.state=r.LicenseStatus.unknown:s.state=r.LicenseStatus.noToken}return s},t.checkInLicense=async function(e,t){try{const n=i.handleToken(t);await o.axiosPostWithToken(await i.RequestPath_v1.CheckIn(),n,{runnerID:e})}catch(e){}},t.heartbeat=async function(e,t){try{const n=i.handleToken(t);await o.axiosPostWithToken(await i.RequestPath_v1.HeartBeat(),n,{runnerID:e})}catch(e){}},t.getLicenseState=function(){return s}},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("retry-axios")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.noToken=-3]="noToken",e[e.invalidToken=-2]="invalidToken",e[e.unknown=-1]="unknown",e[e.valid=1]="valid",e[e.full=2]="full"}(t.LicenseStatus||(t.LicenseStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),r=n(0),i=n(1);var s,a;!function(e){e[e.unknown=-1]="unknown",e[e.valid=0]="valid",e[e.invalid=1]="invalid",e[e.error=2]="error"}(s=t.AuthStatus||(t.AuthStatus={})),function(e){e.auth="Authentication",e.exec="Execution",e.unknown="unknown"}(a=t.LoginType||(t.LoginType={}));const c={auth:"",state:s.unknown,type:a.unknown,userID:0};function u(e){c.auth="",c.state=e,c.type=a.unknown,c.userID=0}async function l(e){const t={username:"",password:"",executionToken:e};try{const n=await o.axiosPost(await r.RequestPath_v1.Login(),t);if(200===n.status){c.state=s.valid,c.auth=e;const t=n.data;"Authentication"===t.tokenType?c.type=a.auth:"Execution"===t.tokenType&&(c.type=a.exec),c.userID=t.userID;const o=await r.getServer();r.saveAuthInfoToDevice(e,o,t.tokenType,r.DATA_PATH)}else i.logger.error("[Login] Failed with status: "+n.status)}catch(e){e.response&&401===e.response.status?u(s.invalid):u(s.error),i.logger.error("[Login] Failed with error: "+e)}}t.basicLogin=async function(e,t){const n={username:e,password:t,executionToken:""};try{const e=await o.axiosPost(await r.RequestPath_v1.Login(),n);if(200===e.status){const t=e.data,n=t.authenticationToken,o=await r.getServer();r.saveAuthInfoToDevice(n,o,t.tokenType,r.DATA_PATH),c.auth=n,c.state=s.valid,c.type=a.auth,c.userID=t.userID}}catch(e){e.response&&401===e.response.status?u(s.invalid):u(s.error)}},t.authLogin=l,t.logout=async function(){const e=r.getAuthInfoFromDevice(r.DATA_PATH).auth;o.axiosPostWithToken(await r.RequestPath_v1.Logout(),e,{}),r.removeAuthInfoFromDevice(r.DATA_PATH),u(s.unknown)},t.getLoginState=function(){return c},t.getPackagesLicense=async function(e){const t=[];try{const n=await o.axiosGetWithToken(await r.RequestPath_v1.LicenseInfo(),e,void 0);if(200===n.status){n.data.forEach(e=>{t.push({planName:e.planName,expireDate:e.expireDate?e.expireDate:""})})}}catch(e){}return t},t.genExecutionToken=async function(e,t,n){const i={duration:parseInt(t,10),label:n},a={state:s.invalid,token:""};try{const t=await o.axiosPostWithToken(await r.RequestPath_v1.Token(),e,i);200===t.status&&(a.state=s.valid,a.token=t.data.executionToken)}catch(e){}return a},t.autoLogin=async function(){const e=r.getAuthInfoFromDevice(r.DATA_PATH),t=e.auth,n=e.server;""===t&&i.logger.error("[AutoLogin] Token is empty"),r.setServerURL(n),t?await l(t):u(s.unknown),c.state!==s.valid&&i.logger.error("[AutoLogin] Failed with AuthStatus: "+c.state)}},function(e,t){e.exports=require("uuid/v4")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(19),r=n(5);t.EventCategory=r.EventCategory,t.UserTimingVariable=r.UserTimingVariable;const i=n(2),s=n(24);let a;function c(){return a||(a=new o.Analyzer),a}async function u(e,t,n,o,s,a,u,l,f){if("boolean"==typeof e){if(!1===e)return}else if(!1===e())return;await new Promise(async(e,d)=>{try{let d=!0;f&&("boolean"==typeof f.isTestExecuted?(d=!f.isTestExecuted,f.isSkipped=t!==r.EventCategory.HeliumFW&&f.isTestExecuted):"function"==typeof f.isTestExecuted&&(d=!1===f.isTestExecuted(),f.isSkipped=t!==r.EventCategory.HeliumFW&&!0===f.isTestExecuted())),i.logger.setActive(d),i.logger.info(JSON.stringify(u)),i.logger.info(JSON.stringify(l)),i.logger.info(`${s} - ${a}`),i.logger.info(JSON.stringify(f));const g=c();if(g)if(u&&"object"==typeof u){const e=u;for(const[n,o]of Object.entries(e))o&&await g.event(t,n,o,f)}else g.event(t,n,o,f);e()}catch(e){i.logger.error("Failed to send analytics: "+e),d()}})}t.sendActionsStatistic=async function(e,t,n){if("boolean"==typeof e){if(!1===e)return}else if(!1===e())return;await new Promise(async(e,o)=>{try{const e=r.EventCategory.HeliumFW;let o=!0;n&&("boolean"==typeof n.isTestExecuted?(o=!n.isTestExecuted,n.isSkipped=e!==r.EventCategory.HeliumFW&&n.isTestExecuted):"function"==typeof n.isTestExecuted&&(o=!1===n.isTestExecuted(),n.isSkipped=e!==r.EventCategory.HeliumFW&&!0===n.isTestExecuted())),i.logger.setActive(o),i.logger.info(JSON.stringify(n));const s=c();if(s)for(const[o,r]of t)await s.trackAction(e,o,r,n)}catch(e){i.logger.error("Failed to send analytics: "+e),o()}e()})},t.sendLocatorsStatistic=async function(e,t,n){if("boolean"==typeof e){if(!1===e)return}else if(!1===e())return;const o=r.EventCategory.HeliumFW;let s=!0;n&&("boolean"==typeof n.isTestExecuted?(s=!n.isTestExecuted,n.isSkipped=o!==r.EventCategory.HeliumFW&&n.isTestExecuted):"function"==typeof n.isTestExecuted&&(s=!1===n.isTestExecuted(),n.isSkipped=o!==r.EventCategory.HeliumFW&&!0===n.isTestExecuted())),i.logger.setActive(s),i.logger.info(JSON.stringify(n));const a=c();if(a)for(const[e,r]of t)await a.trackLocator(o,e,r,n)},t.sendTelemetryEvent=u,t.captureTelemetry=function(e,t,n,o,r,i=!0,a){return(c,l,f)=>{const d=f.value;return f.value=function(...c){if(!1===e())return d.apply(this,c);const l=new s.StopWatch;if(!i)return u(e,t,n,o,l.startTime,void 0,r,void 0,a),d.apply(this,c);const f=d.apply(this,c);return f&&"function"==typeof f.then&&"function"==typeof f.catch?f.then(i=>(u(e,t,n,o,l.startTime,l.elapsedTime,r,void 0,a),i)).catch(i=>{(r=r||{}).failed=!0,u(e,t,n,o,l.startTime,l.elapsedTime,r,i,a)}):u(e,t,n,o,l.startTime,l.elapsedTime,r,void 0,a),f},f}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5),r=n(2),i=n(20);t.Analyzer=class{constructor(){r.logger.info("Create new GAReporter successfully"),this.report=new i.GAReporter}async trackAction(e,t,n,r){if(this.report){const i={t:"event",ec:o.EventCategory[e],el:t,ea:"Action",ev:n};await this.report.send(i,r)}}async trackLocator(e,t,n,r){if(this.report){const i={t:"event",ec:o.EventCategory[e],el:t,ea:"LocatorStrategy",ev:n};return this.report.send(i,r)}}event(e,t,n,r){if(this.report){const i={ec:o.EventCategory[e],ea:t,t:"event",el:n};this.report.send(i,r)}}error(e,t,n){const o={exd:e.split(/[\n\{\/\\]/)[0].substring(0,150).trim(),exf:t?1:0,t:"exception"};this.report.send(o,n)}time(e,t,n,r,i){const s={t:"timing",utc:o.EventCategory[e],utl:r,utt:Math.round(n),utv:o.UserTimingVariable[t]};this.report.send(s,i)}}},function(e,t,n){"use strict";var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(21)),i=n(22),s=o(n(23)),a=n(2),c=()=>"true"===process.env.GS_DEBUG_MODE,u="UA-155073229-1",l="UA-134732439-2";t.GAReporter=class{async send(e,t){if(t&&!0===t.isSkipped)return;const n={aip:1,an:"Gondola Studio",av:t&&t.av?t.av:"",tid:"true"===process.env.GS_TESTING_MODE?u:l,ul:t&&t.ul?t.ul:"",v:"1"};let o;o=t&&t.cid?t.cid:await i.machineId(!0),Object.assign(n,{cid:o}),t&&t.uid&&Object.assign(n,{uid:t.uid}),Object.assign(n,e),c()&&a.logger.info(JSON.stringify(n));const f={headers:{"Content-Type":"application/x-www-form-urlencoded"},hostname:"www.google-analytics.com",method:"POST",path:c()?"/debug/collect":"/collect",port:443};await new Promise(t=>{try{const o=r.request(f,n=>{c()&&n.on("data",t=>{try{const n=JSON.parse(t.toString());n&&n.hitParsingResult&&!0===n.hitParsingResult[0].valid?a.logger.info("{Event category: "+e.ec+"} {Event name: "+e.ea+"} sent OK!"):n&&n.hitParsingResult&&!1===n.hitParsingResult[0].valid?a.logger.warn(t.toString()):a.logger.warn("Unexpected GA debug response: "+t.toString())}catch(e){a.logger.warn("Error in GA debug response: "+t.toString())}}),(!n||!n.statusCode||n.statusCode<200||n.statusCode>300)&&a.logger.info(`Failed to send analytics ${n&&n.statusCode}: ${n&&n.statusMessage}`),t()});o.on("error",e=>{c()&&a.logger.error("Failed to make http request: "+e),t()}),o.write(s.stringify(n)),o.end()}catch(e){a.logger.error("Failed to send analytics: "+e),t()}})}}},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("node-machine-id")},function(e,t){e.exports=require("querystring")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StopWatch=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}get startTime(){return this.started}reset(){this.started=Date.now()}}},function(e,t){e.exports=require("ip")}]);